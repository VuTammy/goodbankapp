{"ast":null,"code":"import _slicedToArray from\"/Users/tammyvu/Desktop/goodbank/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import Card from\"./context.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var globalBalance=0;function Withdraw(){var _React$useState=React.useState(true),_React$useState2=_slicedToArray(_React$useState,2),show=_React$useState2[0],setShow=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),status=_React$useState4[0],setStatus=_React$useState4[1];return/*#__PURE__*/_jsx(Card,{bgcolor:\"light\",txtcolor:\"black\",header:\"Withdraw\",cardWidth:\"40%\",status:status,body:show?/*#__PURE__*/_jsx(WithdrawForm,{setShow:setShow,setStatus:setStatus}):/*#__PURE__*/_jsx(WithdrawMsg,{setShow:setShow,setStatus:setStatus})});}function WithdrawMsg(props){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsxs(\"h5\",{children:[\"Withdraw successful!\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"em\",{children:[\"New balance: $\",globalBalance]})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-danger\",onClick:function onClick(){props.setShow(true);props.setStatus('');},children:\"Withdraw again\"})]});}function WithdrawForm(props){var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),amount=_React$useState6[0],setAmount=_React$useState6[1];var _React$useState7=React.useState(parseInt(localStorage.getItem('balance'))),_React$useState8=_slicedToArray(_React$useState7,2),withdrawBalance=_React$useState8[0],setBalance=_React$useState8[1];globalBalance=localStorage.getItem('balance');var name=localStorage.getItem('name');var email=localStorage.getItem('email');function handle(){function validate(field,label){if(!field||amount<0){props.setStatus('Error: '+label);setTimeout(function(){return props.setStatus('');},3000);return false;}return true;}if(!validate(amount,'Not a valid input.'))return;fetch(\"/account/update/\".concat(email,\"/-\").concat(amount)).then(function(response){return response.text();}).then(function(text){try{var data=JSON.parse(text);props.setStatus(false);props.setShow(false);globalBalance=globalBalance-amount;setBalance(globalBalance);console.log(\"global balance\",globalBalance);console.log(\"typeof withdraw\",typeof withdrawBalance);console.log('JSON:',data);console.log('withdraw',withdrawBalance);console.log('local storage:',localStorage.getItem('balance'));localStorage.setItem('balance',data.value.balance);}catch(err){props.setStatus('Withdraw failed');console.log('err:',text);}});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"center\",{children:/*#__PURE__*/_jsxs(\"b\",{children:[\"Welcome \",name,\"! Use this page to withdraw money from your account.\"]})}),/*#__PURE__*/_jsx(\"br\",{}),amount,/*#__PURE__*/_jsxs(\"em\",{children:[\"Account Balance: \",/*#__PURE__*/_jsx(\"em\",{children:withdrawBalance}),\" \"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),\"Withdraw Amount\",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",placeholder:\"Enter amount\",value:amount,onChange:function onChange(e){return setAmount(e.currentTarget.value);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-danger\",onClick:handle,children:\"Submit Withdraw\"})]});}export default Withdraw;","map":{"version":3,"names":["React","Card","globalBalance","Withdraw","useState","show","setShow","status","setStatus","WithdrawMsg","props","WithdrawForm","amount","setAmount","parseInt","localStorage","getItem","withdrawBalance","setBalance","name","email","handle","validate","field","label","setTimeout","fetch","then","response","text","data","JSON","parse","console","log","setItem","value","balance","err","e","currentTarget"],"sources":["/Users/tammyvu/Desktop/goodbank/src/components/withdraw.js"],"sourcesContent":["import React from \"react\";\nimport Card from \"./context.js\";\n\nvar globalBalance = 0;\n\n\nfunction Withdraw(){\n  const [show, setShow]     = React.useState(true);\n  const [status, setStatus] = React.useState('');  \n\n  return (\n    <Card\n      bgcolor=\"light\"\n      txtcolor=\"black\"\n      header=\"Withdraw\"\n      cardWidth='40%'\n      status={status}\n      body={show ? \n        <WithdrawForm setShow={setShow} setStatus={setStatus}/> :\n        <WithdrawMsg setShow={setShow} setStatus={setStatus}/>}\n    />\n  );\n}\n\nfunction WithdrawMsg(props){\n\n  return(<>\n    <center><h5>\n      Withdraw successful!<br/><br/>\n      <em>New balance: ${globalBalance}</em>\n    </h5></center>\n    <br/>\n    <button type=\"submit\" \n      className=\"btn btn-danger\" \n      onClick={() => {\n        props.setShow(true);\n        props.setStatus('');\n      }}>\n        Withdraw again\n    </button>\n  </>);\n}\n\nfunction WithdrawForm(props){\n  const [amount, setAmount] = React.useState('');\n  const [withdrawBalance, setBalance] = React.useState(parseInt(localStorage.getItem('balance')));\n  globalBalance = localStorage.getItem('balance');\n  var name = localStorage.getItem('name');\n  var email = localStorage.getItem('email');\n\n  function handle(){\n    function validate(field, label){\n      if (!field || amount < 0) {\n          props.setStatus('Error: ' + label);\n          setTimeout(() => props.setStatus(''),3000);\n          return false;\n      }\n      return true;\n    }\n    if (!validate(amount, 'Not a valid input.'))   return;\n    fetch(`/account/update/${email}/-${amount}`)\n    .then(response => response.text())\n    .then(text => {\n        try {\n            const data = JSON.parse(text);\n            props.setStatus(false);\n            props.setShow(false);\n            globalBalance = globalBalance - amount;\n            setBalance(globalBalance);\n            console.log(\"global balance\", globalBalance);\n            console.log(\"typeof withdraw\", typeof(withdrawBalance));\n            console.log('JSON:', data);\n            console.log('withdraw', withdrawBalance);\n            console.log('local storage:' , localStorage.getItem('balance'));\n            localStorage.setItem('balance', data.value.balance);\n        } catch(err) {\n            props.setStatus('Withdraw failed')\n            console.log('err:', text);\n        }\n    });\n  }\n\n\n  return(<>\n\n    <center><b>Welcome {name}! Use this page to withdraw money from your account.</b></center>\n    <br/>\n    {amount}\n    <em>Account Balance: <em>{withdrawBalance}</em> </em>\n    <br/><br/>\n\n    Withdraw Amount<br/>\n    <input type=\"number\" \n      className=\"form-control\" \n      placeholder=\"Enter amount\" \n      value={amount} \n      onChange={e => setAmount(e.currentTarget.value)}/><br/>\n\n    <button type=\"submit\" \n      className=\"btn btn-danger\" \n      onClick={handle}>Submit Withdraw</button>\n\n  </>);\n}\n\nexport default Withdraw;"],"mappings":"qHAAA,MAAOA,MAAK,KAAM,OAAO,CACzB,MAAOC,KAAI,KAAM,cAAc,CAAC,6IAEhC,GAAIC,cAAa,CAAG,CAAC,CAGrB,QAASC,SAAQ,EAAE,CACjB,oBAA4BH,KAAK,CAACI,QAAQ,CAAC,IAAI,CAAC,oDAAzCC,IAAI,qBAAEC,OAAO,qBACpB,qBAA4BN,KAAK,CAACI,QAAQ,CAAC,EAAE,CAAC,qDAAvCG,MAAM,qBAAEC,SAAS,qBAExB,mBACE,KAAC,IAAI,EACH,OAAO,CAAC,OAAO,CACf,QAAQ,CAAC,OAAO,CAChB,MAAM,CAAC,UAAU,CACjB,SAAS,CAAC,KAAK,CACf,MAAM,CAAED,MAAO,CACf,IAAI,CAAEF,IAAI,cACR,KAAC,YAAY,EAAC,OAAO,CAAEC,OAAQ,CAAC,SAAS,CAAEE,SAAU,EAAE,cACvD,KAAC,WAAW,EAAC,OAAO,CAAEF,OAAQ,CAAC,SAAS,CAAEE,SAAU,EAAG,EACzD,CAEN,CAEA,QAASC,YAAW,CAACC,KAAK,CAAC,CAEzB,mBAAO,wCACL,qCAAQ,0DACc,aAAK,2BAAK,cAC9B,uCAAmBR,aAAa,GAAM,GACnC,EAAS,cACd,aAAK,cACL,eAAQ,IAAI,CAAC,QAAQ,CACnB,SAAS,CAAC,gBAAgB,CAC1B,OAAO,CAAE,kBAAM,CACbQ,KAAK,CAACJ,OAAO,CAAC,IAAI,CAAC,CACnBI,KAAK,CAACF,SAAS,CAAC,EAAE,CAAC,CACrB,CAAE,4BAEK,GACR,CACL,CAEA,QAASG,aAAY,CAACD,KAAK,CAAC,CAC1B,qBAA4BV,KAAK,CAACI,QAAQ,CAAC,EAAE,CAAC,qDAAvCQ,MAAM,qBAAEC,SAAS,qBACxB,qBAAsCb,KAAK,CAACI,QAAQ,CAACU,QAAQ,CAACC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,qDAAxFC,eAAe,qBAAEC,UAAU,qBAClChB,aAAa,CAAGa,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAC/C,GAAIG,KAAI,CAAGJ,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,CACvC,GAAII,MAAK,CAAGL,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAEzC,QAASK,OAAM,EAAE,CACf,QAASC,SAAQ,CAACC,KAAK,CAAEC,KAAK,CAAC,CAC7B,GAAI,CAACD,KAAK,EAAIX,MAAM,CAAG,CAAC,CAAE,CACtBF,KAAK,CAACF,SAAS,CAAC,SAAS,CAAGgB,KAAK,CAAC,CAClCC,UAAU,CAAC,iBAAMf,MAAK,CAACF,SAAS,CAAC,EAAE,CAAC,GAAC,IAAI,CAAC,CAC1C,MAAO,MAAK,CAChB,CACA,MAAO,KAAI,CACb,CACA,GAAI,CAACc,QAAQ,CAACV,MAAM,CAAE,oBAAoB,CAAC,CAAI,OAC/Cc,KAAK,2BAAoBN,KAAK,cAAKR,MAAM,EAAG,CAC3Ce,IAAI,CAAC,SAAAC,QAAQ,QAAIA,SAAQ,CAACC,IAAI,EAAE,GAAC,CACjCF,IAAI,CAAC,SAAAE,IAAI,CAAI,CACV,GAAI,CACA,GAAMC,KAAI,CAAGC,IAAI,CAACC,KAAK,CAACH,IAAI,CAAC,CAC7BnB,KAAK,CAACF,SAAS,CAAC,KAAK,CAAC,CACtBE,KAAK,CAACJ,OAAO,CAAC,KAAK,CAAC,CACpBJ,aAAa,CAAGA,aAAa,CAAGU,MAAM,CACtCM,UAAU,CAAChB,aAAa,CAAC,CACzB+B,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEhC,aAAa,CAAC,CAC5C+B,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAE,MAAOjB,gBAAgB,CAAC,CACvDgB,OAAO,CAACC,GAAG,CAAC,OAAO,CAAEJ,IAAI,CAAC,CAC1BG,OAAO,CAACC,GAAG,CAAC,UAAU,CAAEjB,eAAe,CAAC,CACxCgB,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAGnB,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC,CAAC,CAC/DD,YAAY,CAACoB,OAAO,CAAC,SAAS,CAAEL,IAAI,CAACM,KAAK,CAACC,OAAO,CAAC,CACvD,CAAE,MAAMC,GAAG,CAAE,CACT5B,KAAK,CAACF,SAAS,CAAC,iBAAiB,CAAC,CAClCyB,OAAO,CAACC,GAAG,CAAC,MAAM,CAAEL,IAAI,CAAC,CAC7B,CACJ,CAAC,CAAC,CACJ,CAGA,mBAAO,wCAEL,qCAAQ,gCAAYV,IAAI,0DAAyD,EAAS,cAC1F,aAAK,CACJP,MAAM,cACP,uDAAqB,oBAAKK,eAAe,EAAM,OAAM,cACrD,aAAK,2BAAK,gCAEK,aAAK,cACpB,cAAO,IAAI,CAAC,QAAQ,CAClB,SAAS,CAAC,cAAc,CACxB,WAAW,CAAC,cAAc,CAC1B,KAAK,CAAEL,MAAO,CACd,QAAQ,CAAE,kBAAA2B,CAAC,QAAI1B,UAAS,CAAC0B,CAAC,CAACC,aAAa,CAACJ,KAAK,CAAC,EAAC,EAAE,2BAAK,cAEzD,eAAQ,IAAI,CAAC,QAAQ,CACnB,SAAS,CAAC,gBAAgB,CAC1B,OAAO,CAAEf,MAAO,6BAAyB,GAE1C,CACL,CAEA,cAAelB,SAAQ"},"metadata":{},"sourceType":"module"}